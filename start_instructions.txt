# Nightingale 项目启动命令

## 1. 启动后端（FastAPI）

在项目根目录下依次执行：

```
cd backend
..\venv\Scripts\activate  # 激活虚拟环境（Windows）
```

激活后，运行：

```
..\venv\Scripts\python.exe -m uvicorn app.main:app --reload
```



---

## 2. 启动前端（React）

另开一个命令行窗口，执行：

```
cd ambiance-weaver-react
npm start
```

---

## 3. 访问

- 前端地址: http://localhost:3000
- 后端 API: http://localhost:8000

---

如遇到环境/依赖问题，建议先删除并重建 venv，再 `pip install -r backend/requirements.txt`。

---

## 4. Stable Audio Open Small 测试环境（分支 feature/layered-audio 专用）

本项目为 Stable Audio Open Small 测试功能单独准备了虚拟环境，互不影响主项目依赖。

### 创建/激活虚拟环境（仅首次需创建）

```powershell
# 进入项目根目录
cd C:\Users\t-yaxuanmao\Desktop\Nightingale

# 创建虚拟环境（如已存在可跳过）
python -m venv venv_stable_audio

# Windows PowerShell 激活
.\venv_stable_audio\Scripts\Activate.ps1

# Windows CMD 激活
venv_stable_audio\Scripts\activate.bat
```

### 安装依赖

```powershell
pip install -r backend/app/services/requirements_stable_audio.txt
```

### 运行Stable Audio测试脚本

```powershell
python backend/app/services/stable_audio_test.py
```

---

如遇 PowerShell 执行策略限制，可先运行：

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process
```

---

## 5. WSL (Linux) 下开发与运行指南

### 1. 进入 WSL 终端
- 在 Windows 开始菜单搜索 "Ubuntu" 或 "WSL"，点击打开。

### 2. 进入项目目录
```bash
cd ~/Nightingale
```

### 3. 创建并激活 Python 虚拟环境（Stable Audio 测试专用）
```bash
python3 -m venv venv_stable_audio
source venv_stable_audio/bin/activate
```

### 4. 安装 Python 依赖
```bash
pip install -r backend/app/services/requirements_stable_audio.txt
```
如遇 PyTorch 安装问题，可用官方源（CPU 版）：
```bash
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu
```

### 5. 运行 Stable Audio 测试脚本
```bash
python backend/app/services/stable_audio_test.py
```

### 6. 前端开发环境配置与启动
```bash
cd ~/Nightingale/ambiance-weaver-react
npm install
npm start
```

### 7. 后端（FastAPI）启动（如需）
新开一个 WSL 终端窗口：
```bash
cd ~/Nightingale/backend
# 如有 requirements.txt
pip install -r requirements.txt
uvicorn app.main:app --reload
```

### 8. 访问
- 前端: http://localhost:3000
- 后端: http://localhost:8000

---

如遇 WSL/Linux 环境问题，欢迎随时提问！
